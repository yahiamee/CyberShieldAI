"""
Translation system for CyberShield AI
Supports Arabic and English languages
"""

TRANSLATIONS = {
    'en': {
        # Navigation
        'home': 'Home',
        'scan': 'Scan',
        'dashboard': 'Dashboard',
        'admin': 'Admin',
        'login': 'Login',
        'logout': 'Logout',
        'register': 'Register',
        'language': 'Language',
        'arabic': 'Arabic',
        'english': 'English',
        
        # Common
        'welcome': 'Welcome',
        'save': 'Save',
        'cancel': 'Cancel',
        'delete': 'Delete',
        'edit': 'Edit',
        'view': 'View',
        'download': 'Download',
        'search': 'Search',
        'submit': 'Submit',
        'back': 'Back',
        'next': 'Next',
        'previous': 'Previous',
        'close': 'Close',
        'loading': 'Loading...',
        'error': 'Error',
        'success': 'Success',
        'warning': 'Warning',
        'info': 'Info',
        
        # Home Page
        'hero_title': 'CyberShield AI',
        'hero_subtitle': 'Intelligent Web Security Scanner',
        'hero_description': 'Protect your websites with advanced security scanning and AI-powered risk assessment',
        'get_started': 'Get Started',
        'start_scanning': 'Start Scanning',
        'feature_security': 'Security Scanning',
        'feature_security_desc': 'Comprehensive website security analysis using advanced scanning techniques',
        'feature_ai': 'AI-Powered Analysis',
        'feature_ai_desc': 'Machine learning algorithms for intelligent risk assessment and classification',
        'feature_reports': 'Detailed Reports',
        'feature_reports_desc': 'Professional PDF reports with actionable recommendations',
        
        # Vulnerabilities
        'vulnerabilities_scanned': 'Vulnerabilities We Scan',
        'vulnerabilities_description': 'Our comprehensive security scanner detects and analyzes the following vulnerabilities:',
        'xss': 'Cross-Site Scripting (XSS)',
        'xss_desc': 'Detection of XSS vulnerabilities that allow attackers to inject malicious scripts into web pages',
        'sqli': 'SQL Injection (SQLi)',
        'sqli_desc': 'Identification of SQL injection flaws that could lead to database compromise',
        'csrf': 'Cross-Site Request Forgery (CSRF)',
        'csrf_desc': 'Detection of CSRF vulnerabilities that allow unauthorized actions on behalf of users',
        'xxe': 'XML External Entity (XXE)',
        'xxe_desc': 'Identification of XXE vulnerabilities in XML processing',
        'ssrf': 'Server-Side Request Forgery (SSRF)',
        'ssrf_desc': 'Detection of SSRF vulnerabilities that could expose internal network resources',
        'rce': 'Remote Code Execution (RCE)',
        'rce_desc': 'Identification of vulnerabilities that could allow remote code execution',
        'idor': 'Insecure Direct Object References (IDOR)',
        'idor_desc': 'Detection of IDOR vulnerabilities that expose unauthorized access to resources',
        'security_misconfig': 'Security Misconfiguration',
        'security_misconfig_desc': 'Identification of security misconfigurations and default settings',
        'sensitive_data': 'Sensitive Data Exposure',
        'sensitive_data_desc': 'Detection of exposed sensitive information and credentials',
        'broken_auth': 'Broken Authentication',
        'broken_auth_desc': 'Identification of authentication and session management flaws',
        'insecure_deserialization': 'Insecure Deserialization',
        'insecure_deserialization_desc': 'Detection of insecure deserialization vulnerabilities',
        'api_security': 'API Security Issues',
        'api_security_desc': 'Identification of API security vulnerabilities and misconfigurations',
        'security_headers': 'Security Headers Analysis',
        'security_headers_desc': 'Comprehensive analysis of HTTP security headers (CSP, HSTS, X-Frame-Options, etc.)',
        'ssl_tls': 'SSL/TLS Configuration',
        'ssl_tls_desc': 'Analysis of SSL/TLS configuration and certificate issues',
        'clickjacking': 'Clickjacking Protection',
        'clickjacking_desc': 'Detection of missing clickjacking protection mechanisms',
        'information_disclosure': 'Information Disclosure',
        'information_disclosure_desc': 'Identification of information leakage and data exposure',
        
        # Login/Register
        'username': 'Username',
        'password': 'Password',
        'email': 'Email',
        'confirm_password': 'Confirm Password',
        'dont_have_account': "Don't have an account?",
        'register_here': 'Register here',
        'already_have_account': 'Already have an account?',
        'login_here': 'Login here',
        
        # Scan
        'website_security_scanner': 'Website Security Scanner',
        'enter_url': 'Enter a URL below to perform a comprehensive security analysis',
        'website_url': 'Website URL',
        'scan_type': 'Scan Type',
        'basic_scan': 'Basic Scan (Fast - HTTP Headers & Response Analysis)',
        'advanced_scan': 'Advanced Scan (OWASP ZAP - Comprehensive Security Analysis)',
        'basic_desc': 'Quick analysis of HTTP headers and response codes.',
        'advanced_desc': 'Deep security scan using OWASP ZAP (requires ZAP proxy running).',
        'scan_website': 'Scan Website Security',
        
        # Results
        'professional_security_analysis': 'Professional Security Analysis',
        'scan_overview': 'Scan Overview',
        'target_url': 'Target URL',
        'status_code': 'Status Code',
        'scan_id': 'Scan ID',
        'performance_metrics': 'Performance & Security Metrics',
        'response_time': 'Response Time',
        'headers_detected': 'Headers Detected',
        'security_headers': 'Security Headers',
        'scan_another': 'Scan Another Website',
        'view_dashboard': 'View Dashboard',
        'download_report': 'Download Report',
        'results': 'Results',
        
        # Dashboard
        'my_dashboard': 'My Dashboard',
        'scan_history': 'Scan History',
        'no_scans': 'No scans yet.',
        'start_first_scan': 'Start your first scan',
        'date': 'Date',
        'actions': 'Actions',
        
        # Admin
        'admin_dashboard': 'Admin Dashboard',
        'administrator_mode': 'Administrator Mode',
        'user_management': 'User Management',
        'all_scans_history': 'All Scans History',
        'role': 'Role',
        'created_at': 'Created At',
        
        # ZAP
        'zap_status': 'ZAP Status',
        'running': 'Running',
        'not_running': 'Not Running',
        'configure_zap': 'Configure ZAP Settings',
        
        # OpenAI
        'openai_ai_analysis': 'OpenAI AI Analysis',
        'enabled': 'Enabled',
        'disabled': 'Disabled',
        'configure_openai': 'Configure OpenAI Settings',
        
        # Status
        'status': 'Status',
        
        # ZAP Settings
        'zap_settings': 'ZAP Settings',
        'zap_proxy_url': 'ZAP Proxy URL',
        'zap_api_key': 'ZAP API Key',
        'enable_zap_integration': 'Enable ZAP Integration',
        'auto_start_zap': 'Auto-start ZAP',
        'proxy_url': 'Proxy URL',
        'configuration': 'Configuration',
        'leave_empty_to_disable': 'Leave empty to disable API key',
        
        # OpenAI Settings
        'openai_settings': 'OpenAI Settings',
        'openai_api_key': 'OpenAI API Key',
        'openai_model': 'OpenAI Model',
        'temperature': 'Temperature',
        'enable_openai_analysis': 'Enable OpenAI AI Analysis',
        'when_enabled_description': 'When enabled, scan results will be automatically analyzed using OpenAI to generate professional security reports.',
        'about_openai_integration': 'About OpenAI Integration',
        'what_does_openai_do': 'What does OpenAI do?',
        'when_enabled_generates': 'When enabled, OpenAI analyzes your security scan results and generates:',
        'executive_summary': 'Executive Summary',
        'executive_summary_desc': 'High-level overview of security posture',
        'critical_findings': 'Critical Findings',
        'critical_findings_desc': 'Most important security issues identified',
        'security_headers_analysis': 'Security Headers Analysis',
        'security_headers_analysis_desc': 'Detailed analysis of HTTP security headers',
        'vulnerability_assessment': 'Vulnerability Assessment',
        'vulnerability_assessment_desc': 'Comprehensive analysis of detected vulnerabilities',
        'risk_assessment': 'Risk Assessment',
        'risk_assessment_desc': 'Overall risk level with justification',
        'prioritized_recommendations': 'Prioritized Recommendations',
        'prioritized_recommendations_desc': 'Actionable steps for remediation',
        'best_practices': 'Best Practices',
        'best_practices_desc': 'Additional security recommendations',
        'getting_api_key': 'Getting an API Key',
        'visit_openai_platform': 'Visit OpenAI Platform and create an account',
        'go_to_api_keys': 'Go to API Keys section',
        'create_new_key': 'Create a new API key',
        'copy_paste_key': 'Copy and paste it in the form above',
        'openai_usage_note': 'OpenAI API usage incurs costs. Monitor your usage at OpenAI Usage Dashboard',
        'connected': 'Connected',
        'not_connected': 'Not Connected',
        'configure_api_key': 'Please configure your API key to enable AI analysis.',
        'select_model_description': 'Select the OpenAI model to use for analysis. GPT-4 provides the best quality but is more expensive.',
        'temperature_description': 'Controls randomness. Lower values (0.0-0.5) make output more focused and deterministic. Higher values (0.7-2.0) make output more creative. Recommended: 0.7',
        'get_key_from': 'Your OpenAI API key. Get one from',
        'gpt4_recommended': 'GPT-4 (Recommended - Best Quality)',
        'gpt4_turbo': 'GPT-4 Turbo (Faster)',
        'gpt35_turbo': 'GPT-3.5 Turbo (Cost-Effective)',
        'gpt35_turbo_16k': 'GPT-3.5 Turbo 16k (Long Context)',
        'ready_to_use': 'and ready to use.',
        'zap_info_text': 'To use the Advanced Scan feature, you need to have OWASP ZAP installed and running.',
        'download_zap': 'Download ZAP',
        'zap_configure_note': 'Ensure ZAP is configured to listen on the specified Proxy URL (default: http://127.0.0.1:8080).',
    },
    'ar': {
        # Navigation
        'home': 'الرئيسية',
        'scan': 'فحص',
        'dashboard': 'لوحة التحكم',
        'admin': 'الإدارة',
        'login': 'تسجيل الدخول',
        'logout': 'تسجيل الخروج',
        'register': 'إنشاء حساب',
        'language': 'اللغة',
        'arabic': 'العربية',
        'english': 'English',
        
        # Common
        'welcome': 'مرحباً',
        'save': 'حفظ',
        'cancel': 'إلغاء',
        'delete': 'حذف',
        'edit': 'تعديل',
        'view': 'عرض',
        'download': 'تحميل',
        'search': 'بحث',
        'submit': 'إرسال',
        'back': 'رجوع',
        'next': 'التالي',
        'previous': 'السابق',
        'close': 'إغلاق',
        'loading': 'جاري التحميل...',
        'error': 'خطأ',
        'success': 'نجح',
        'warning': 'تحذير',
        'info': 'معلومات',
        
        # Home Page
        'hero_title': 'CyberShield AI',
        'hero_subtitle': 'ماسح أمني ذكي للمواقع',
        'hero_description': 'احمِ مواقعك باستخدام الفحص الأمني المتقدم وتقييم المخاطر المدعوم بالذكاء الاصطناعي',
        'get_started': 'ابدأ الآن',
        'start_scanning': 'ابدأ الفحص',
        'feature_security': 'فحص أمني',
        'feature_security_desc': 'تحليل أمني شامل للمواقع باستخدام تقنيات فحص متقدمة',
        'feature_ai': 'تحليل بالذكاء الاصطناعي',
        'feature_ai_desc': 'خوارزميات تعلم آلي لتقييم المخاطر الذكي والتصنيف',
        'feature_reports': 'تقارير مفصلة',
        'feature_reports_desc': 'تقارير PDF احترافية مع توصيات قابلة للتطبيق',
        
        # Vulnerabilities
        'vulnerabilities_scanned': 'الثغرات التي نقوم بفحصها',
        'vulnerabilities_description': 'يقوم ماسح الأمان الشامل لدينا باكتشاف وتحليل الثغرات التالية:',
        'xss': 'ثغرة XSS (Cross-Site Scripting)',
        'xss_desc': 'اكتشاف ثغرات XSS التي تسمح للمهاجمين بحقن سكريبتات خبيثة في صفحات الويب',
        'sqli': 'ثغرة SQL Injection',
        'sqli_desc': 'تحديد ثغرات SQL injection التي قد تؤدي إلى اختراق قاعدة البيانات',
        'csrf': 'ثغرة CSRF (Cross-Site Request Forgery)',
        'csrf_desc': 'اكتشاف ثغرات CSRF التي تسمح بإجراءات غير مصرح بها نيابة عن المستخدمين',
        'xxe': 'ثغرة XXE (XML External Entity)',
        'xxe_desc': 'تحديد ثغرات XXE في معالجة XML',
        'ssrf': 'ثغرة SSRF (Server-Side Request Forgery)',
        'ssrf_desc': 'اكتشاف ثغرات SSRF التي قد تكشف موارد الشبكة الداخلية',
        'rce': 'ثغرة RCE (Remote Code Execution)',
        'rce_desc': 'تحديد الثغرات التي قد تسمح بتنفيذ كود عن بُعد',
        'idor': 'ثغرة IDOR (Insecure Direct Object References)',
        'idor_desc': 'اكتشاف ثغرات IDOR التي تكشف الوصول غير المصرح به للموارد',
        'security_misconfig': 'إعدادات الأمان الخاطئة',
        'security_misconfig_desc': 'تحديد إعدادات الأمان الخاطئة والإعدادات الافتراضية',
        'sensitive_data': 'كشف البيانات الحساسة',
        'sensitive_data_desc': 'اكتشاف المعلومات الحساسة المعرضة وأوراق الاعتماد',
        'broken_auth': 'مصادقة معطلة',
        'broken_auth_desc': 'تحديد عيوب المصادقة وإدارة الجلسات',
        'insecure_deserialization': 'إلغاء التسلسل غير الآمن',
        'insecure_deserialization_desc': 'اكتشاف ثغرات إلغاء التسلسل غير الآمن',
        'api_security': 'مشاكل أمان API',
        'api_security_desc': 'تحديد ثغرات أمان API وإعدادات الأمان الخاطئة',
        'security_headers': 'تحليل رؤوس الأمان',
        'security_headers_desc': 'تحليل شامل لرؤوس HTTP الأمنية (CSP, HSTS, X-Frame-Options، إلخ)',
        'ssl_tls': 'إعدادات SSL/TLS',
        'ssl_tls_desc': 'تحليل إعدادات SSL/TLS ومشاكل الشهادات',
        'clickjacking': 'حماية من Clickjacking',
        'clickjacking_desc': 'اكتشاف آليات الحماية المفقودة من Clickjacking',
        'information_disclosure': 'كشف المعلومات',
        'information_disclosure_desc': 'تحديد تسريب المعلومات وكشف البيانات',
        
        # Login/Register
        'username': 'اسم المستخدم',
        'password': 'كلمة المرور',
        'email': 'البريد الإلكتروني',
        'confirm_password': 'تأكيد كلمة المرور',
        'dont_have_account': 'ليس لديك حساب؟',
        'register_here': 'سجل هنا',
        'already_have_account': 'لديك حساب بالفعل؟',
        'login_here': 'سجل الدخول هنا',
        
        # Scan
        'website_security_scanner': 'ماسح أمني للمواقع',
        'enter_url': 'أدخل رابط الموقع أدناه لإجراء تحليل أمني شامل',
        'website_url': 'رابط الموقع',
        'scan_type': 'نوع الفحص',
        'basic_scan': 'فحص أساسي (سريع - تحليل رؤوس HTTP والاستجابة)',
        'advanced_scan': 'فحص متقدم (OWASP ZAP - تحليل أمني شامل)',
        'basic_desc': 'تحليل سريع لرؤوس HTTP ورموز الاستجابة.',
        'advanced_desc': 'فحص أمني عميق باستخدام OWASP ZAP (يتطلب تشغيل ZAP proxy).',
        'scan_website': 'فحص أمان الموقع',
        
        # Results
        'professional_security_analysis': 'تحليل أمني احترافي',
        'scan_overview': 'نظرة عامة على الفحص',
        'target_url': 'الرابط المستهدف',
        'status_code': 'رمز الحالة',
        'scan_id': 'معرف الفحص',
        'performance_metrics': 'مقاييس الأداء والأمان',
        'response_time': 'وقت الاستجابة',
        'headers_detected': 'رؤوس مكتشفة',
        'security_headers': 'رؤوس الأمان',
        'scan_another': 'فحص موقع آخر',
        'view_dashboard': 'عرض لوحة التحكم',
        'download_report': 'تحميل التقرير',
        'results': 'النتائج',
        
        # Dashboard
        'my_dashboard': 'لوحة التحكم الخاصة بي',
        'scan_history': 'سجل الفحوصات',
        'no_scans': 'لا توجد فحوصات بعد.',
        'start_first_scan': 'ابدأ فحصك الأول',
        'date': 'التاريخ',
        'actions': 'الإجراءات',
        
        # Admin
        'admin_dashboard': 'لوحة تحكم المدير',
        'administrator_mode': 'وضع المدير',
        'user_management': 'إدارة المستخدمين',
        'all_scans_history': 'سجل جميع الفحوصات',
        'role': 'الدور',
        'created_at': 'تاريخ الإنشاء',
        
        # ZAP
        'zap_status': 'حالة ZAP',
        'running': 'يعمل',
        'not_running': 'لا يعمل',
        'configure_zap': 'إعدادات ZAP',
        
        # OpenAI
        'openai_ai_analysis': 'تحليل بالذكاء الاصطناعي',
        'enabled': 'مفعل',
        'disabled': 'معطل',
        'configure_openai': 'إعدادات OpenAI',
        
        # Status
        'status': 'الحالة',
        
        # ZAP Settings
        'zap_settings': 'إعدادات ZAP',
        'zap_proxy_url': 'رابط ZAP Proxy',
        'zap_api_key': 'مفتاح ZAP API',
        'enable_zap_integration': 'تفعيل تكامل ZAP',
        'auto_start_zap': 'تشغيل ZAP تلقائياً',
        'proxy_url': 'رابط الـ Proxy',
        'configuration': 'الإعدادات',
        'leave_empty_to_disable': 'اتركه فارغاً لتعطيل مفتاح API',
        
        # OpenAI Settings
        'openai_settings': 'إعدادات OpenAI',
        'openai_api_key': 'مفتاح OpenAI API',
        'openai_model': 'نموذج OpenAI',
        'temperature': 'Temperature',
        'enable_openai_analysis': 'تفعيل تحليل OpenAI بالذكاء الاصطناعي',
        'when_enabled_description': 'عند التفعيل، سيتم تحليل نتائج الفحص تلقائياً باستخدام OpenAI لإنشاء تقارير أمنية احترافية.',
        'about_openai_integration': 'حول تكامل OpenAI',
        'what_does_openai_do': 'ماذا يفعل OpenAI؟',
        'when_enabled_generates': 'عند التفعيل، يحلل OpenAI نتائج فحص الأمان ويولد:',
        'executive_summary': 'ملخص تنفيذي',
        'executive_summary_desc': 'نظرة عامة عالية المستوى على الوضع الأمني',
        'critical_findings': 'النتائج الحرجة',
        'critical_findings_desc': 'أهم مشاكل الأمان المكتشفة',
        'security_headers_analysis': 'تحليل رؤوس الأمان',
        'security_headers_analysis_desc': 'تحليل مفصل لرؤوس HTTP الأمنية',
        'vulnerability_assessment': 'تقييم الثغرات',
        'vulnerability_assessment_desc': 'تحليل شامل للثغرات المكتشفة',
        'risk_assessment': 'تقييم المخاطر',
        'risk_assessment_desc': 'مستوى المخاطر الإجمالي مع التبرير',
        'prioritized_recommendations': 'توصيات ذات أولوية',
        'prioritized_recommendations_desc': 'خطوات قابلة للتطبيق للإصلاح',
        'best_practices': 'أفضل الممارسات',
        'best_practices_desc': 'توصيات أمنية إضافية',
        'getting_api_key': 'الحصول على مفتاح API',
        'visit_openai_platform': 'قم بزيارة منصة OpenAI وإنشاء حساب',
        'go_to_api_keys': 'انتقل إلى قسم مفاتيح API',
        'create_new_key': 'أنشئ مفتاح API جديد',
        'copy_paste_key': 'انسخه والصقه في النموذج أعلاه',
        'openai_usage_note': 'استخدام OpenAI API يتكلف مالاً. راقب استخدامك في لوحة استخدام OpenAI',
        'connected': 'متصل',
        'not_connected': 'غير متصل',
        'configure_api_key': 'يرجى تكوين مفتاح API الخاص بك لتفعيل التحليل بالذكاء الاصطناعي.',
        'select_model_description': 'اختر نموذج OpenAI للاستخدام في التحليل. GPT-4 يوفر أفضل جودة ولكنه أغلى.',
        'temperature_description': 'يتحكم في العشوائية. القيم المنخفضة (0.0-0.5) تجعل المخرجات أكثر تركيزاً وحتمية. القيم العالية (0.7-2.0) تجعل المخرجات أكثر إبداعاً. موصى به: 0.7',
        'get_key_from': 'مفتاح OpenAI API الخاص بك. احصل عليه من',
        'gpt4_recommended': 'GPT-4 (موصى به - أفضل جودة)',
        'gpt4_turbo': 'GPT-4 Turbo (أسرع)',
        'gpt35_turbo': 'GPT-3.5 Turbo (اقتصادي)',
        'gpt35_turbo_16k': 'GPT-3.5 Turbo 16k (سياق طويل)',
        'ready_to_use': 'وجاهز للاستخدام.',
        'zap_info_text': 'لاستخدام ميزة الفحص المتقدم، يجب أن يكون OWASP ZAP مثبتاً ويعمل.',
        'download_zap': 'تحميل ZAP',
        'zap_configure_note': 'تأكد من أن ZAP مُكوّن للاستماع على رابط Proxy المحدد (الافتراضي: http://127.0.0.1:8080).',
    }
}

def get_translation(key, lang='en'):
    """Get translation for a key in the specified language"""
    return TRANSLATIONS.get(lang, TRANSLATIONS['en']).get(key, key)

def get_current_language():
    """Get current language from session or default to English"""
    from flask import session
    return session.get('language', 'en')

