from docx import Document
from docx.shared import Inches, Pt, RGBColor, Cm
from docx.enum.text import WD_ALIGN_PARAGRAPH
import os

# Create a new Document in Arabic
doc = Document()

# Set page margins
sections = doc.sections
for section in sections:
    section.top_margin = Cm(2.54)
    section.bottom_margin = Cm(2.54)
    section.left_margin = Cm(2.54)
    section.right_margin = Cm(2.54)

# Set default font
style = doc.styles['Normal']
font = style.font
font.name = 'Arial'
font.size = Pt(12)
style.paragraph_format.line_spacing = 1.15
style.paragraph_format.space_after = Pt(6)

# Add title page
title = doc.add_heading('تقرير شامل عن مشروع CyberShield AI', 0)
title.alignment = WD_ALIGN_PARAGRAPH.CENTER
title_run = title.runs[0]
title_run.font.size = Pt(28)
title_run.font.bold = True
title_run.font.color.rgb = RGBColor(0, 51, 102)

subtitle = doc.add_paragraph('نظام ذكي لفحص أمان المواقع الإلكترونية باستخدام الذكاء الاصطناعي')
subtitle.alignment = WD_ALIGN_PARAGRAPH.CENTER
subtitle_format = subtitle.runs[0].font
subtitle_format.size = Pt(18)
subtitle_format.bold = True
subtitle_format.color.rgb = RGBColor(0, 51, 102)

doc.add_page_break()

# Introduction
doc.add_heading('مقدمة المشروع', 1)
intro_text = """تم إعداد هذا التقرير لتوثيق جميع مراحل تطوير مشروع CyberShield AI بشكل مفصل ومنهجي، بدءاً من مرحلة التخطيط وتهيئة البيئة التطويرية وصولاً إلى النظام النهائي المتكامل. يهدف هذا التقرير إلى تقديم وصف شامل لجميع المهام والخطوات التي تم تنفيذها خلال فترة تطوير المشروع، مع التركيز على التفاصيل التقنية والمنهجية المتبعة في كل مرحلة."""
doc.add_paragraph(intro_text)

doc.add_heading('نظرة عامة على المشروع', 1)
overview_text = """CyberShield AI هو نظام متكامل لفحص أمان المواقع الإلكترونية يستخدم تقنيات متقدمة في مجال الأمن السيبراني والذكاء الاصطناعي. تم تطوير هذا النظام بهدف توفير أداة شاملة وسهلة الاستخدام لفحص المواقع الإلكترونية واكتشاف الثغرات الأمنية المحتملة. يعتمد النظام على عدة تقنيات حديثة تشمل إطار عمل Flask لتطوير الويب، ومكتبة OWASP ZAP للفحص الأمني المتقدم، وتكامل مع OpenAI لتحليل النتائج وتوليد تقارير احترافية.

الهدف الرئيسي من المشروع هو إنشاء منصة ويب تسمح للمستخدمين بفحص المواقع الإلكترونية لاكتشاف الثغرات الأمنية الشائعة مثل XSS و SQL Injection و CSRF وغيرها من الثغرات المعروفة. يوفر النظام واجهة مستخدم بسيطة وسهلة الاستخدام، مع إمكانية توليد تقارير PDF احترافية تحتوي على تحليل شامل للنتائج وتوصيات قابلة للتطبيق."""
doc.add_paragraph(overview_text)

# Week sections
weeks_data = [
    {
        'title': 'الأسبوع الأول: التخطيط والتحليل',
        'content': """خلال الأسبوع الأول من المشروع، تم التركيز على فهم متطلبات المشروع وتحليل الفكرة الأساسية. تم تعريف الهدف الرئيسي للمشروع وهو إنشاء نظام ذكي لفحص أمان المواقع الإلكترونية يستخدم الذكاء الاصطناعي لتقييم المخاطر. تم تحديد الميزات الأساسية التي يجب أن يتضمنها النظام، والتي تشمل فحص المواقع الإلكترونية، اكتشاف الثغرات الأمنية، تصنيف المخاطر باستخدام الذكاء الاصطناعي، وتوليد تقارير PDF احترافية.

تم تحليل الجمهور المستهدف للنظام، والذي يشمل الشركات الصغيرة والمتوسطة، المطورين، ومهنيي الأمن السيبراني. كما تم تحديد الأدوات والتقنيات التي سيتم استخدامها في المشروع، بما في ذلك Python كلغة برمجة رئيسية، Flask كإطار عمل للويب، SQLite كقاعدة بيانات، Bootstrap للواجهة الأمامية، و ReportLab لتوليد التقارير.

تم إنشاء وثيقة تحليل أولية تحتوي على الهدف من المشروع، الميزات الأساسية، الجمهور المستهدف، والأدوات المطلوبة. هذه الوثيقة شكلت الأساس الذي تم البناء عليه في المراحل اللاحقة من المشروع.""",
        'images': ['[مكان الصورة: مخطط تحليل المشروع - يوضح الهدف والميزات والجمهور المستهدف]']
    },
    {
        'title': 'الأسبوع الثاني: التصميم والهندسة المعمارية',
        'content': """في الأسبوع الثاني، تم التركيز على تصميم البنية المعمارية للنظام وتخطيط قاعدة البيانات. تم إنشاء مخطط معماري يوضح تدفق البيانات والتفاعل بين مكونات النظام المختلفة. يتكون النظام من عدة طبقات رئيسية تشمل واجهة المستخدم، طبقة التطبيق التي تعتمد على Flask، محرك الفحص الأمني، قاعدة البيانات، ومولد التقارير.

تم تصميم قاعدة البيانات باستخدام SQLite، وتتضمن ثلاثة جداول رئيسية. الجدول الأول هو جدول المستخدمين users الذي يحتوي على الحقول التالية: المعرف الفريد id، اسم المستخدم username، البريد الإلكتروني email، كلمة المرور المشفرة password_hash، صلاحية المدير is_admin، وتاريخ الإنشاء created_at. الجدول الثاني هو جدول الفحوصات scans الذي يحتوي على المعرف الفريد id، رابط الموقع المفحوص url، رمز الحالة HTTP status_code، رؤوس HTTP headers، تاريخ الفحص scan_date، معرف المستخدم user_id، ونتائج فحص ZAP zap_results. الجدول الثالث هو جدول الإعدادات settings الذي يحتوي على المعرف الفريد id، مفتاح الإعداد setting_key، قيمة الإعداد setting_value، وتاريخ التحديث updated_at.

تم إنشاء رسومات تخطيطية للواجهة المستخدم باستخدام أدوات التصميم، مع التركيز على سهولة الاستخدام والتصميم الحديث. تم تصميم الصفحات الرئيسية للنظام بما في ذلك الصفحة الرئيسية، صفحة تسجيل الدخول، صفحة التسجيل، صفحة الفحص، صفحة النتائج، ولوحة التحكم.""",
        'images': [
            '[مكان الصورة: مخطط البنية المعمارية للنظام - يوضح تدفق البيانات بين المكونات]',
            '[مكان الصورة: مخطط قاعدة البيانات ERD - يوضح الجداول والعلاقات بينها]',
            '[مكان الصورة: تصميمات واجهة المستخدم - رسومات تخطيطية للصفحات الرئيسية]'
        ]
    },
    {
        'title': 'الأسبوع الثالث: تهيئة البيئة التطويرية وتثبيت Python',
        'content': """خلال الأسبوع الثالث، تم البدء في تهيئة البيئة التطويرية وتثبيت جميع الأدوات المطلوبة. تم تثبيت Python 3.10 أو أحدث على النظام، حيث يعتبر Python اللغة البرمجة الرئيسية المستخدمة في المشروع. تم التحقق من التثبيت بنجاح من خلال فتح Terminal أو Command Prompt وتنفيذ الأمر python --version للتأكد من أن الإصدار المثبت صحيح.

بعد تثبيت Python، تم تثبيت pip وهو مدير الحزم الخاص بـ Python. تم استخدام pip لتثبيت جميع المكتبات المطلوبة للمشروع. تم إنشاء ملف requirements.txt الذي يحتوي على قائمة بجميع المكتبات المطلوبة مع إصداراتها المحددة. المكتبات الرئيسية التي تم تثبيتها تشمل Flask 2.3.2 كإطار عمل للويب، Flask-Login 0.6.2 لإدارة المصادقة، requests 2.31.0 لإرسال طلبات HTTP، reportlab 4.0.4 لتوليد ملفات PDF، scikit-learn 1.3.0 للتعلم الآلي، pandas 2.0.3 لمعالجة البيانات، numpy 1.24.3 للعمليات الحسابية، python-owasp-zap-v2.4 0.0.22 لتكامل OWASP ZAP، و openai 1.3.0 لتكامل OpenAI.

تم تثبيت جميع المكتبات باستخدام الأمر pip install -r requirements.txt. تم التحقق من التثبيت الناجح لجميع المكتبات من خلال محاولة استيرادها في Python. تم أيضاً تثبيت محرر النصوص Visual Studio Code وتكوينه للعمل مع Python، بما في ذلك تثبيت إضافات Python و Python Debugger.

تم إنشاء مجلد المشروع الرئيسي CyberShieldAI وإنشاء البنية الأساسية للمشروع. تم إنشاء المجلدات التالية: templates لملفات HTML، static للملفات الثابتة مثل CSS و JavaScript، models للنماذج ومولد التقارير، و reports لحفظ التقارير المولدة. تم أيضاً إنشاء ملف app.py الرئيسي الذي يحتوي على تطبيق Flask الأساسي.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لتثبيت Python - يظهر إصدار Python المثبت]',
            '[مكان الصورة: لقطة شاشة لتثبيت المكتبات - يظهر تنفيذ الأمر pip install -r requirements.txt]',
            '[مكان الصورة: هيكل مجلدات المشروع - يوضح التنظيم الداخلي للملفات]'
        ]
    },
    {
        'title': 'الأسبوع الرابع: تطوير النظام الأساسي و Flask',
        'content': """خلال الأسبوع الرابع، تم البدء في تطوير النظام الأساسي باستخدام Flask. تم إنشاء ملف app.py الرئيسي الذي يحتوي على تهيئة تطبيق Flask وإعدادات أساسية. تم تكوين Flask-Login لإدارة المصادقة والجلسات. تم إنشاء كلاس User الذي يمثل المستخدم في النظام ويتوافق مع متطلبات Flask-Login.

تم إنشاء ملف database.py الذي يحتوي على جميع دوال إدارة قاعدة البيانات. تم إنشاء دالة init_db التي تقوم بتهيئة قاعدة البيانات وإنشاء جميع الجداول المطلوبة. تم إنشاء جدول المستخدمين users مع جميع الحقول المطلوبة، وتم إنشاء جدول الفحوصات scans مع الحقول الأساسية. تم أيضاً إنشاء مستخدم admin افتراضي عند تهيئة قاعدة البيانات لأول مرة، مع اسم المستخدم admin وكلمة المرور admin123.

تم إنشاء القوالب الأساسية للواجهة المستخدم. تم إنشاء ملف base.html الذي يحتوي على الهيكل الأساسي لجميع الصفحات، بما في ذلك شريط التنقل والرأس والتذييل. تم إنشاء ملف index.html للصفحة الرئيسية التي تحتوي على قسم Hero يوضح ميزات النظام، وقسم المميزات الذي يشرح قدرات النظام المختلفة.

تم إنشاء صفحة login.html لتسجيل الدخول وصفحة register.html للتسجيل. تم ربط هذه الصفحات مع دوال في app.py للتعامل مع طلبات تسجيل الدخول والتسجيل. تم استخدام Werkzeug لتشفير كلمات المرور باستخدام دالة generate_password_hash والتحقق منها باستخدام check_password_hash.

تم إنشاء route أساسي للصفحة الرئيسية و route لتسجيل الدخول والتسجيل. تم اختبار النظام الأساسي من خلال تشغيل الخادم المحلي والوصول إلى الصفحة الرئيسية في المتصفح على العنوان http://localhost:5000.""",
        'images': [
            '[مكان الصورة: لقطة شاشة للصفحة الرئيسية - يظهر التصميم الأساسي]',
            '[مكان الصورة: لقطة شاشة لصفحة تسجيل الدخول - يظهر النموذج الأساسي]',
            '[مكان الصورة: كود app.py الأساسي - يوضح التهيئة والـ routes الأساسية]'
        ]
    },
    {
        'title': 'الأسبوع الخامس: تطوير نظام الفحص الأساسي',
        'content': """خلال الأسبوع الخامس، تم تطوير نظام الفحص الأساسي للمواقع الإلكترونية. تم إنشاء route جديد /scan في app.py للتعامل مع طلبات الفحص. تم إنشاء صفحة scan.html التي تحتوي على نموذج لإدخال رابط الموقع المراد فحصه واختيار نوع الفحص سواء كان أساسياً أو متقدماً.

تم تطوير دالة perform_basic_scan التي تقوم بفحص الموقع الأساسي. تقوم هذه الدالة بإرسال طلب HTTP GET إلى الموقع المحدد باستخدام مكتبة requests. يتم استخراج رمز الحالة HTTP من الاستجابة، وجمع جميع رؤوس HTTP المرسلة من الخادم. يتم أيضاً قياس وقت الاستجابة للموقع.

تم تطوير دالة analyze_headers التي تقوم بتحليل رؤوس HTTP لاكتشاف رؤوس الأمان المهمة. يتم البحث عن رؤوس الأمان الشائعة مثل Content-Security-Policy و X-Frame-Options و X-Content-Type-Options و Strict-Transport-Security و X-XSS-Protection. يتم تقييم كل رأس أمان وتحديد ما إذا كان موجوداً ومضبوطاً بشكل صحيح أم لا.

تم تحديث دالة add_scan_result في database.py لحفظ نتائج الفحص في قاعدة البيانات. يتم حفظ رابط الموقع، رمز الحالة، رؤوس HTTP، وتاريخ الفحص. يتم ربط كل فحص بالمستخدم الذي قام به من خلال user_id.

تم إنشاء صفحة results.html لعرض نتائج الفحص. تعرض هذه الصفحة نظرة عامة على الفحص بما في ذلك رابط الموقع المفحوص، رمز الحالة HTTP، وقت الاستجابة، وتاريخ الفحص. يتم عرض جميع رؤوس HTTP في جدول منظم، مع تمييز رؤوس الأمان بألوان مختلفة.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لصفحة الفحص - يظهر النموذج لإدخال الرابط]',
            '[مكان الصورة: لقطة شاشة لصفحة النتائج - يظهر عرض النتائج الأساسية]',
            '[مكان الصورة: كود دالة perform_basic_scan - يوضح منطق الفحص الأساسي]'
        ]
    },
    {
        'title': 'الأسبوع السادس: تطوير نظام توليد التقارير PDF',
        'content': """خلال الأسبوع السادس، تم تطوير نظام شامل لتوليد تقارير PDF احترافية. تم إنشاء ملف report_generator.py داخل مجلد models. تم استخدام مكتبة ReportLab لتوليد ملفات PDF بتنسيق احترافي.

تم إنشاء دالة generate_pdf_report التي تقبل نتائج الفحص كمعاملات وتقوم بإنشاء تقرير PDF شامل. يتم إنشاء التقرير بتنسيق A4 مع هوامش مناسبة. يتم إضافة رأس الصفحة الذي يحتوي على عنوان التقرير وشعار النظام وتاريخ التوليد.

يحتوي التقرير على عدة أقسام رئيسية. القسم الأول هو نظرة عامة على الفحص ويحتوي على معلومات أساسية مثل رابط الموقع المفحوص، رمز الحالة HTTP، وتاريخ الفحص. القسم الثاني هو تحليل رؤوس HTTP ويحتوي على جدول يوضح جميع رؤوس HTTP المستخرجة من الاستجابة.

القسم الثالث هو تحليل رؤوس الأمان ويحتوي على تحليل مفصل لرؤوس الأمان المهمة. يتم تقييم كل رأس أمان وتحديد ما إذا كان موجوداً ومضبوطاً بشكل صحيح. يتم إضافة توصيات لكل رأس أمان مفقود أو غير مضبوط بشكل صحيح.

يتم استخدام ألوان مختلفة في التقرير لتمييز المعلومات المهمة. يتم استخدام اللون الأحمر للثغرات الحرجة، واللون البرتقالي للتحذيرات، واللون الأخضر للمعلومات الإيجابية. يتم استخدام خطوط مناسبة للعناوين والنصوص العادية.

يتم حفظ التقرير في مجلد reports مع اسم فريد يحتوي على معرف الفحص. تم إضافة route جديد /download_report/<scan_id> في app.py للسماح للمستخدمين بتحميل التقارير. يتم استخدام دالة send_file من Flask لإرسال الملف للمستخدم.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لتقرير PDF - يظهر التصميم والتنسيق]',
            '[مكان الصورة: كود دالة generate_pdf_report - يوضح منطق توليد التقرير]',
            '[مكان الصورة: مثال على تقرير PDF مكتمل - يظهر جميع الأقسام]'
        ]
    },
    {
        'title': 'الأسبوع السابع: تكامل OWASP ZAP',
        'content': """خلال الأسبوع السابع، تم إضافة تكامل مع OWASP ZAP للفحص الأمني المتقدم. OWASP ZAP هو أداة مفتوحة المصدر لاختبار أمان التطبيقات الويب. تم تثبيت مكتبة python-owasp-zap-v2.4 التي توفر واجهة برمجية للتفاعل مع ZAP.

تم إنشاء ملف zap_scanner.py الذي يحتوي على كلاس ZAPScanner الذي يقوم بإدارة الاتصال مع ZAP وتنفيذ الفحوصات. يتم تهيئة الاتصال مع ZAP Proxy على العنوان الافتراضي http://127.0.0.1:8080. يتم التحقق من أن ZAP يعمل وقابل للوصول قبل البدء في أي فحص.

تم تطوير دالة spider_scan التي تقوم بتنفيذ فحص Spider على الموقع المحدد. يقوم Spider بفحص الموقع واكتشاف جميع الروابط والصفحات المتاحة. يتم تحديد عدد أقصى من الصفحات الفرعية للفحص لتجنب الفحص المطول.

تم تطوير دالة active_scan التي تقوم بتنفيذ فحص Active شامل على الموقع. يقوم Active Scan بفحص الموقع بحثاً عن الثغرات الأمنية المعروفة مثل XSS و SQL Injection و CSRF وغيرها. يتم انتظار اكتمال الفحص قبل المتابعة.

تم تطوير دالة get_alerts التي تقوم بجمع جميع التنبيهات الأمنية من ZAP. يتم تصنيف التنبيهات حسب مستوى الخطورة إلى High و Medium و Low و Informational. يتم استخراج معلومات مفصلة عن كل تنبيه بما في ذلك الاسم والوصف والحل المقترح.

تم تحديث قاعدة البيانات لإضافة عمود zap_results في جدول scans لحفظ نتائج فحص ZAP. يتم تحويل نتائج ZAP إلى JSON وحفظها في قاعدة البيانات. تم تحديث صفحة results.html لعرض نتائج ZAP بشكل منظم مع تصنيف التنبيهات حسب مستوى الخطورة.

تم تحديث report_generator.py لإضافة قسم خاص بنتائج ZAP في التقرير. يتم عرض ملخص للتنبيهات مع عدد التنبيهات لكل مستوى خطورة، ثم قائمة مفصلة بجميع التنبيهات مع الوصف والحل المقترح لكل منها.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لإعدادات ZAP - يظهر تكوين الاتصال]',
            '[مكان الصورة: لقطة شاشة لنتائج ZAP - يظهر التنبيهات الأمنية]',
            '[مكان الصورة: كود zap_scanner.py - يوضح منطق التكامل مع ZAP]'
        ]
    },
    {
        'title': 'الأسبوع الثامن: إدارة ZAP التلقائية',
        'content': """خلال الأسبوع الثامن، تم تطوير نظام إدارة تلقائي لـ ZAP لضمان تشغيله بشكل صحيح عند الحاجة. تم ملاحظة أن ZAP يحتاج إلى تشغيل يدوي قبل استخدامه، مما يسبب مشاكل للمستخدمين. تم إنشاء ملف zap_manager.py الذي يحتوي على نظام إدارة تلقائي لـ ZAP.

تم تطوير دالة init_zap التي تقوم بتهيئة ZAP والتحقق من حالته. تم تطوير دالة start_zap_process التي تقوم بتشغيل ZAP في الخلفية كعملية منفصلة. يتم التحقق من وجود ZAP في النظام قبل محاولة تشغيله.

تم تطوير دالة check_zap_status التي تقوم بالتحقق من حالة ZAP وما إذا كان يعمل بشكل صحيح. يتم إرسال طلب إلى ZAP API للتحقق من الاستجابة. تم تطوير دالة stop_zap_process التي تقوم بإيقاف عملية ZAP عند الحاجة.

تم تحديث قاعدة البيانات لإضافة جدول settings لتخزين إعدادات ZAP. تم إضافة الحقول التالية: zap_proxy_url لرابط ZAP Proxy، zap_api_key لمفتاح API الخاص بـ ZAP، zap_auto_start لتفعيل التشغيل التلقائي، و zap_enabled لتفعيل تكامل ZAP بشكل عام.

تم إنشاء صفحة zap_settings.html في لوحة الإدارة لتكوين إعدادات ZAP. تسمح هذه الصفحة للمدير بتحديد رابط ZAP Proxy، إدخال مفتاح API إذا كان مطلوباً، وتفعيل أو تعطيل التشغيل التلقائي. يتم حفظ الإعدادات في قاعدة البيانات.

تم تحديث صفحة admin_dashboard.html لإضافة بطاقة حالة ZAP التي تعرض ما إذا كان ZAP يعمل أم لا. يتم التحقق من حالة ZAP بشكل دوري وعرضها في لوحة التحكم. تم إضافة رابط للإعدادات من لوحة التحكم.

تم تحديث app.py لقراءة إعدادات ZAP من قاعدة البيانات عند بدء التطبيق. إذا كان التشغيل التلقائي مفعلاً، يتم محاولة تشغيل ZAP تلقائياً. يتم التحقق من حالة ZAP قبل كل فحص متقدم لضمان أنه يعمل بشكل صحيح.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لصفحة إعدادات ZAP - يظهر التكوين الكامل]',
            '[مكان الصورة: لقطة شاشة لحالة ZAP في لوحة التحكم - يظهر الحالة الحالية]',
            '[مكان الصورة: كود zap_manager.py - يوضح منطق الإدارة التلقائية]'
        ]
    },
    {
        'title': 'الأسبوع التاسع: تحسين الواجهات ومعالجة الأخطاء',
        'content': """خلال الأسبوع التاسع، تم تحسين جميع واجهات المستخدم وإضافة معالجة شاملة للأخطاء. تم إضافة try-except blocks في جميع الدوال الحرجة لالتقاط ومعالجة الأخطاء بشكل صحيح. تم إضافة رسائل خطأ واضحة ومفيدة للمستخدمين عند حدوث أي مشكلة.

تم تحسين واجهات المستخدم بإضافة رسائل تحميل أثناء تنفيذ الفحص. يتم عرض رسالة "جارٍ الفحص..." مع مؤشر تحميل أثناء انتظار اكتمال الفحص. يتم إخفاء الرسالة عند اكتمال الفحص وعرض النتائج.

تم إضافة رسائل نجاح وخطأ واضحة في جميع أنحاء النظام. يتم استخدام نظام Flash Messages في Flask لعرض الرسائل للمستخدمين. يتم عرض الرسائل بألوان مختلفة حسب النوع، الأخضر للنجاح، الأحمر للأخطاء، والأزرق للمعلومات.

تم تحسين تصميم جميع الصفحات باستخدام Bootstrap لضمان التصميم المتجاوب والعصري. تم إضافة تحسينات على الألوان والخطوط والمسافات لتحسين تجربة المستخدم. تم إضافة أيقونات مناسبة في جميع أنحاء الواجهة.

تم إنشاء صفحات خطأ مخصصة للرموز 404 و 500 و 403. تحتوي هذه الصفحات على رسائل واضحة وتصميم متسق مع باقي النظام. يتم توجيه المستخدمين تلقائياً إلى هذه الصفحات عند حدوث الأخطاء المقابلة.

تم تحسين الأمان من خلال تنظيف المدخلات من المستخدمين. تم إضافة دالة clean_url التي تقوم بتنظيف وتحقق من صحة URLs المدخلة. يتم إزالة الأحرف غير المرغوب فيها والتحقق من تنسيق URL الصحيح. تم إضافة حماية من CSRF باستخدام Flask-WTF.

تم إصلاح مشكلة إنشاء مجلد reports. يتم التحقق من وجود المجلد قبل محاولة إنشاء الملفات. إذا لم يكن المجلد موجوداً، يتم إنشاؤه تلقائياً. يتم معالجة جميع الأخطاء المتعلقة بإنشاء الملفات بشكل صحيح.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لرسائل الخطأ - يظهر التصميم والوضوح]',
            '[مكان الصورة: لقطة شاشة لصفحة الخطأ 404 - يظهر التصميم المخصص]',
            '[مكان الصورة: لقطة شاشة لرسائل التحميل - يظهر المؤشر والرسالة]'
        ]
    },
    {
        'title': 'الأسبوع العاشر: تحسين التقارير',
        'content': """خلال الأسبوع العاشر، تم تحسين نظام التقارير بشكل شامل لجعله أكثر احترافية وتفصيلاً. تم ملاحظة أن التقارير السابقة كانت بسيطة جداً ولا تعرض جميع النتائج بشكل كافٍ. تم إعادة تصميم التقارير بالكامل.

تم تحديث صفحة results.html لعرض جميع المعلومات بشكل أفضل. يتم عرض جميع رؤوس HTTP في جدول منظم مع تمييز رؤوس الأمان بألوان مختلفة. يتم عرض نتائج ZAP بشكل مفصل مقسم حسب مستوى الخطورة. يتم عرض تحليل شامل لرؤوس الأمان مع توصيات لكل رأس.

تم تحديث ملف report_generator.py لإضافة أقسام جديدة في التقرير. تم إضافة قسم تحليل شامل لرؤوس HTTP يوضح كل رأس ووظيفته. تم إضافة قسم تحليل رؤوس الأمان مع تقييم مفصل لكل رأس أمان وتوصيات لإصلاح المشاكل.

تم إضافة قسم مفصل لنتائج ZAP في التقرير. يتم عرض ملخص للتنبيهات مع عدد التنبيهات لكل مستوى خطورة. ثم يتم عرض قائمة مفصلة بجميع التنبيهات مع الاسم والوصف والحل المقترح لكل تنبيه. يتم تنظيم التنبيهات حسب مستوى الخطورة مع عرض التنبيهات الحرجة أولاً.

تم تحسين تنسيق PDF باستخدام ألوان وخطوط مناسبة. يتم استخدام خط Arial للعناوين وخط Times New Roman للنصوص العادية. يتم استخدام ألوان مختلفة لتمييز المعلومات المهمة. يتم استخدام جداول منظمة لعرض البيانات بشكل واضح.

تم إضافة رسوم بيانية في التقرير لعرض إحصائيات الفحص. يتم عرض مخطط دائري يوضح توزيع التنبيهات حسب مستوى الخطورة. يتم عرض مخطط شريطي يوضح عدد رؤوس الأمان الموجودة مقابل المفقودة.""",
        'images': [
            '[مكان الصورة: لقطة شاشة للتقارير المحسنة - يظهر التصميم الجديد]',
            '[مكان الصورة: مثال على تقرير PDF محسن - يظهر جميع الأقسام الجديدة]',
            '[مكان الصورة: الرسوم البيانية في التقرير - يظهر المخططات الدائرية والشرائطية]'
        ]
    },
    {
        'title': 'الأسبوع الحادي عشر: تكامل OpenAI',
        'content': """خلال الأسبوع الحادي عشر، تم إضافة تكامل مع OpenAI لاستخدام الذكاء الاصطناعي في تحليل نتائج الفحص وتوليد تقارير احترافية. تم تثبيت مكتبة openai 1.3.0 وإضافتها إلى requirements.txt.

تم إنشاء ملف openai_analyzer.py الذي يحتوي على كلاس OpenAIAnalyzer لإدارة الاتصال مع OpenAI. يتم تهيئة العميل باستخدام مفتاح API المقدم. يتم التحقق من صحة مفتاح API من خلال محاولة اتصال بسيطة.

تم تطوير دالة analyze_scan_results التي تقوم بتحليل نتائج الفحص باستخدام OpenAI. يتم إعداد سياق شامل يحتوي على جميع معلومات الفحص بما في ذلك رابط الموقع، رمز الحالة HTTP، رؤوس HTTP، ونتائج ZAP إذا كانت متاحة. يتم إنشاء prompt محترف يطلب من OpenAI تحليل النتائج وتقديم تقرير شامل.

يتم إرسال الطلب إلى OpenAI API باستخدام نموذج GPT-4 أو GPT-3.5-turbo حسب الإعدادات. يتم استلام الاستجابة وتحليلها. يتم استخراج أقسام مختلفة من التحليل مثل الملخص التنفيذي، النتائج الحرجة، تحليل رؤوس الأمان، تقييم الثغرات، تقييم المخاطر، والتوصيات.

تم تحديث قاعدة البيانات لإضافة إعدادات OpenAI في جدول settings. تم إضافة الحقول التالية: openai_api_key لمفتاح API، openai_enabled لتفعيل تحليل OpenAI، openai_model للنموذج المستخدم، و openai_temperature لدرجة الحرارة للنموذج.

تم إنشاء صفحة openai_settings.html في لوحة الإدارة لتكوين إعدادات OpenAI. تسمح هذه الصفحة للمدير بإدخال مفتاح API، اختيار النموذج، ضبط درجة الحرارة، وتفعيل أو تعطيل تحليل OpenAI. يتم حفظ الإعدادات في قاعدة البيانات.

تم تحديث صفحة admin_dashboard.html لإضافة بطاقة حالة OpenAI التي تعرض ما إذا كان OpenAI مفعلاً ومتاحاً. تم تحديث app.py لإضافة تحليل OpenAI في عملية الفحص. إذا كان OpenAI مفعلاً، يتم استدعاء OpenAI لتحليل النتائج بعد اكتمال الفحص.

تم تحديث صفحة results.html لعرض تحليل OpenAI في قسم منفصل. يتم عرض الملخص التنفيذي، النتائج الحرجة، تحليل رؤوس الأمان، تقييم الثغرات، تقييم المخاطر، التوصيات، وأفضل الممارسات. يتم تنسيق التحليل بشكل جيد مع استخدام ألوان وخطوط مناسبة.

تم تحديث report_generator.py لإضافة قسم تحليل OpenAI في تقرير PDF. يتم عرض التحليل الكامل من OpenAI في قسم منفصل في التقرير مع الحفاظ على التنسيق الاحترافي.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لإعدادات OpenAI - يظهر التكوين الكامل]',
            '[مكان الصورة: لقطة شاشة لتحليل OpenAI - يظهر التحليل المفصل]',
            '[مكان الصورة: كود openai_analyzer.py - يوضح منطق التكامل مع OpenAI]'
        ]
    },
    {
        'title': 'الأسبوع الثاني عشر: دعم اللغات المتعددة',
        'content': """خلال الأسبوع الثاني عشر، تم إضافة دعم كامل للغة العربية والإنجليزية في النظام. تم إنشاء ملف translations.py الذي يحتوي على قاموس TRANSLATIONS يحتوي على جميع النصوص باللغتين العربية والإنجليزية.

يحتوي القاموس على ترجمات لجميع النصوص في النظام بما في ذلك العناوين، الأزرار، الرسائل، التسميات، والأخطاء. تم تنظيم الترجمات بشكل منطقي حسب الصفحات والمكونات. تم إضافة ترجمات لجميع أنواع الثغرات الأمنية التي يقوم النظام بفحصها.

تم تطوير دالة get_translation التي تقوم بالحصول على الترجمة المناسبة حسب اللغة المحددة. إذا لم تكن الترجمة موجودة، يتم إرجاع المفتاح نفسه. تم تطوير دالة get_current_language التي تقوم بالحصول على اللغة الحالية من الجلسة أو استخدام اللغة الافتراضية.

تم تحديث app.py لإضافة route جديد /set_language/<lang> لتبديل اللغة. يتم حفظ اللغة المختارة في الجلسة. تم إضافة context processor لحقن اللغة ودالة الترجمة في جميع القوالب، مما يسمح باستخدام دالة الترجمة مباشرة في القوالب.

تم تحديث base.html لإضافة مبدل اللغة في شريط التنقل. يتم عرض أزرار لتبديل اللغة بين العربية والإنجليزية. تم إضافة دعم RTL للغة العربية من خلال إضافة dir="rtl" و lang="ar" عند اختيار اللغة العربية.

تم إضافة Bootstrap RTL للغة العربية لضمان التصميم الصحيح. تم تحديث جميع القوالب لاستخدام دالة الترجمة بدلاً من النصوص الثابتة. تم تحديث index.html و login.html و register.html و scan.html و results.html و dashboard.html و admin_dashboard.html و zap_settings.html و openai_settings.html.

تم تحديث ملف style.css لإضافة قواعد CSS لدعم RTL. تم إضافة خطوط مناسبة للعربية مثل Arial و Tahoma. تم تعديل الهوامش والمسافات للعربية لضمان التصميم الصحيح. تم إضافة قواعد لضمان محاذاة النصوص بشكل صحيح في كلا الاتجاهين.""",
        'images': [
            '[مكان الصورة: لقطة شاشة للنظام باللغة العربية - يظهر التصميم RTL]',
            '[مكان الصورة: لقطة شاشة لمبدل اللغة - يظهر الأزرار]',
            '[مكان الصورة: لقطة شاشة للنظام باللغة الإنجليزية - يظهر التصميم LTR]'
        ]
    },
    {
        'title': 'الأسبوع الثالث عشر: إضافة قسم الثغرات في الصفحة الرئيسية',
        'content': """خلال الأسبوع الثالث عشر، تم إضافة قسم جديد في الصفحة الرئيسية يوضح جميع الثغرات الأمنية التي يقوم النظام بفحصها. تم إضافة ترجمات لجميع أنواع الثغرات في translations.py باللغتين العربية والإنجليزية.

تم إضافة ترجمات لستة عشر نوعاً من الثغرات الأمنية. النوع الأول هو XSS أو Cross-Site Scripting وهو ثغرة تسمح للمهاجمين بحقن كود JavaScript ضار في صفحات الويب. النوع الثاني هو SQL Injection وهو ثغرة تسمح للمهاجمين بتنفيذ استعلامات SQL ضارة في قاعدة البيانات. النوع الثالث هو CSRF أو Cross-Site Request Forgery وهو ثغرة تسمح للمهاجمين بتنفيذ إجراءات نيابة عن المستخدمين المصرح لهم.

النوع الرابع هو XXE أو XML External Entity وهو ثغرة في معالجة XML تسمح للمهاجمين بقراءة الملفات الحساسة. النوع الخامس هو SSRF أو Server-Side Request Forgery وهو ثغرة تسمح للمهاجمين بإجبار الخادم على إرسال طلبات إلى موارد داخلية. النوع السادس هو RCE أو Remote Code Execution وهو ثغرة تسمح للمهاجمين بتنفيذ كود على الخادم.

النوع السابع هو IDOR أو Insecure Direct Object References وهو ثغرة تسمح للمهاجمين بالوصول إلى موارد غير مصرح بها. النوع الثامن هو Security Misconfiguration وهو ثغرة ناتجة عن إعدادات أمنية غير صحيحة. النوع التاسع هو Sensitive Data Exposure وهو ثغرة تسمح بتعرض البيانات الحساسة.

النوع العاشر هو Broken Authentication وهو ثغرة في أنظمة المصادقة. النوع الحادي عشر هو Insecure Deserialization وهو ثغرة في معالجة البيانات المسلسلة. النوع الثاني عشر هو API Security Issues وهو ثغرات في واجهات برمجة التطبيقات.

النوع الثالث عشر هو Security Headers Analysis وهو تحليل رؤوس الأمان. النوع الرابع عشر هو SSL/TLS Configuration وهو تحليل إعدادات التشفير. النوع الخامس عشر هو Clickjacking Protection وهو حماية من هجمات Clickjacking. النوع السادس عشر هو Information Disclosure وهو كشف المعلومات الحساسة.

تم تحديث index.html لإضافة قسم جديد يعرض جميع هذه الثغرات. يتم عرض عنوان القسم ووصف مختصر. يتم عرض ستة عشر بطاقة، كل بطاقة تعرض ثغرة واحدة مع أيقونة مناسبة واسم الثغرة ووصف مختصر. يتم استخدام ألوان مختلفة حسب مستوى الخطورة، الأحمر للثغرات الحرجة، البرتقالي للثغرات المتوسطة، والأصفر للثغرات المنخفضة.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لقسم الثغرات - يظهر جميع البطاقات]',
            '[مكان الصورة: تفاصيل بطاقة ثغرة - يظهر التصميم والوصف]'
        ]
    },
    {
        'title': 'الأسبوع الرابع عشر: الاختبار النهائي والتوثيق',
        'content': """خلال الأسبوع الرابع عشر والأخير، تم إجراء اختبارات شاملة على جميع مكونات النظام للتأكد من عمله بشكل صحيح. تم اختبار جميع الوظائف الأساسية بما في ذلك التسجيل، تسجيل الدخول، الفحص الأساسي، الفحص المتقدم، عرض النتائج، وتوليد التقارير.

تم اختبار تكامل ZAP للتأكد من أنه يعمل بشكل صحيح ويقوم بفحص المواقع بشكل دقيق. تم اختبار الإدارة التلقائية لـ ZAP للتأكد من أنه يبدأ تلقائياً عند الحاجة. تم اختبار جميع إعدادات ZAP في لوحة الإدارة.

تم اختبار تكامل OpenAI للتأكد من أنه يقوم بتحليل النتائج بشكل صحيح وتوليد تقارير احترافية. تم اختبار جميع إعدادات OpenAI في لوحة الإدارة. تم اختبار النظام مع تفعيل وتعطيل OpenAI للتأكد من أنه يعمل في كلا الحالتين.

تم اختبار دعم اللغات المتعددة للتأكد من أن جميع النصوص تترجم بشكل صحيح. تم اختبار التبديل بين اللغات في جميع الصفحات. تم اختبار التصميم RTL للعربية للتأكد من أنه يعمل بشكل صحيح.

تم اختبار توليد التقارير PDF للتأكد من أنها تحتوي على جميع المعلومات المطلوبة وتكون بتنسيق احترافي. تم اختبار تحميل التقارير من صفحة النتائج. تم اختبار عرض جميع الأقسام في التقرير بما في ذلك نتائج ZAP وتحليل OpenAI.

تم إصلاح جميع الأخطاء التي تم اكتشافها أثناء الاختبار. تم تحسين الأداء من خلال تحسين الاستعلامات إلى قاعدة البيانات وتحسين معالجة البيانات. تم إضافة تحسينات أمنية إضافية لضمان أمان النظام.

تم إنشاء وثائق شاملة للنظام. تم تحديث ملف README.md ليشمل جميع المعلومات المطلوبة عن المشروع. تم إنشاء ملف PROJECT_REPORT.md الذي يحتوي على تقرير شامل عن جميع مراحل التطوير. تم توثيق جميع الدوال والكلاسات في الكود باستخدام docstrings.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لاختبار النظام - يظهر جميع الوظائف]',
            '[مكان الصورة: لقطة شاشة للوثائق - يظهر README.md]'
        ]
    }
]

# Add all week sections
for week in weeks_data:
    doc.add_heading(week['title'], 1)
    paragraphs = week['content'].split('\n\n')
    for para in paragraphs:
        if para.strip():
            p = doc.add_paragraph(para.strip())
            p.paragraph_format.space_after = Pt(6)
    
    # Add image placeholders
    for img in week['images']:
        img_para = doc.add_paragraph(img)
        img_para.paragraph_format.left_indent = Inches(0.5)
        img_para.runs[0].font.italic = True
        img_para.runs[0].font.color.rgb = RGBColor(128, 128, 128)
        img_para.paragraph_format.space_after = Pt(12)
    
    doc.add_paragraph()

# Final sections
final_sections = [
    {
        'title': 'البنية النهائية للمشروع',
        'content': """يتكون المشروع النهائي من عدة ملفات ومجلدات منظمة بشكل منطقي. الملف الرئيسي هو app.py الذي يحتوي على تطبيق Flask الكامل مع جميع الـ routes والوظائف. يحتوي هذا الملف على تهيئة Flask و Flask-Login، جميع routes للتطبيق، معالجة الفحص الأساسي والمتقدم، تكامل ZAP و OpenAI، إدارة اللغة والترجمة، ومعالجة الأخطاء.

ملف database.py يحتوي على جميع دوال إدارة قاعدة البيانات. يحتوي على دالة init_db لتهيئة قاعدة البيانات وإنشاء الجداول، دوال إدارة المستخدمين مثل create_user و get_user_by_username و verify_password، دوال إدارة نتائج الفحوصات مثل add_scan_result و get_scan_results، ودوال إدارة الإعدادات مثل get_setting و update_setting.

ملف zap_scanner.py يحتوي على تكامل OWASP ZAP. يحتوي على كلاس ZAPScanner الذي يدير الاتصال مع ZAP، دالة spider_scan لتنفيذ فحص Spider، دالة active_scan لتنفيذ فحص Active، دالة get_alerts لجمع التنبيهات الأمنية، ودالة quick_scan لتنفيذ فحص سريع شامل.

ملف zap_manager.py يحتوي على إدارة عملية ZAP. يحتوي على دالة init_zap لتهيئة ZAP، دالة start_zap_process لتشغيل ZAP في الخلفية، دالة check_zap_status للتحقق من حالة ZAP، ودالة stop_zap_process لإيقاف ZAP.

ملف openai_analyzer.py يحتوي على تكامل OpenAI. يحتوي على كلاس OpenAIAnalyzer الذي يدير الاتصال مع OpenAI، دالة analyze_scan_results لتحليل نتائج الفحص باستخدام AI، ودوال مساعدة لإعداد السياق وإنشاء الـ prompts.

ملف translations.py يحتوي على إدارة الترجمات. يحتوي على قاموس TRANSLATIONS الذي يحتوي على جميع النصوص باللغتين العربية والإنجليزية، دالة get_translation للحصول على الترجمة، ودالة get_current_language للحصول على اللغة الحالية.

ملف models/report_generator.py يحتوي على توليد التقارير PDF. يحتوي على دالة generate_pdf_report لتوليد تقرير PDF شامل، ودوال مساعدة لتحليل النتائج وتنسيق التقرير.

مجلد templates يحتوي على جميع قوالب HTML. ملف base.html هو القالب الأساسي الذي يحتوي على الهيكل الأساسي لجميع الصفحات مع شريط التنقل ومبدل اللغة. ملف index.html هو الصفحة الرئيسية التي تحتوي على قسم Hero وقسم المميزات وقسم الثغرات. ملف login.html هو صفحة تسجيل الدخول وملف register.html هو صفحة التسجيل.

ملف scan.html هو صفحة الفحص التي تحتوي على نموذج لإدخال رابط الموقع. ملف results.html هو صفحة النتائج التي تعرض جميع نتائج الفحص بما في ذلك نتائج ZAP وتحليل OpenAI. ملف dashboard.html هو لوحة تحكم المستخدم وملف admin_dashboard.html هو لوحة تحكم المدير.

ملف zap_settings.html هو صفحة إعدادات ZAP وملف openai_settings.html هو صفحة إعدادات OpenAI. ملف error.html هو صفحة الأخطاء المخصصة.

مجلد static يحتوي على الملفات الثابتة. ملف style.css يحتوي على جميع تنسيقات CSS بما في ذلك دعم RTL للعربية، تنسيقات للبطاقات والأزرار، وتنسيقات عامة للنظام.

قاعدة البيانات SQLite تحتوي على ثلاثة جداول رئيسية. جدول users يحتوي على معلومات المستخدمين مع الحقول id و username و email و password_hash و is_admin و created_at. جدول scans يحتوي على نتائج الفحوصات مع الحقول id و url و status_code و headers و scan_date و user_id و zap_results. جدول settings يحتوي على إعدادات النظام مع الحقول id و setting_key و setting_value و updated_at.""",
        'images': [
            '[مكان الصورة: هيكل المشروع الكامل - يوضح جميع الملفات والمجلدات]',
            '[مكان الصورة: مخطط قاعدة البيانات - يوضح الجداول والعلاقات]'
        ]
    },
    {
        'title': 'المكتبات المستخدمة',
        'content': """تم استخدام عدة مكتبات Python مهمة في تطوير المشروع. Flask 2.3.2 هو إطار عمل الويب الرئيسي المستخدم لتطوير التطبيق. يوفر Flask بنية بسيطة وقوية لتطوير تطبيقات الويب. Flask-Login 0.6.2 يستخدم لإدارة المصادقة والجلسات. يسمح Flask-Login بإدارة المستخدمين المسجلين بسهولة.

requests 2.31.0 يستخدم لإرسال طلبات HTTP إلى المواقع المراد فحصها. توفر requests واجهة بسيطة وقوية لإرسال الطلبات والتعامل مع الاستجابات. reportlab 4.0.4 يستخدم لتوليد ملفات PDF. يوفر reportlab إمكانيات قوية لإنشاء تقارير PDF احترافية مع تنسيق متقدم.

scikit-learn 1.3.0 يستخدم للتعلم الآلي. pandas 2.0.3 يستخدم لمعالجة البيانات. numpy 1.24.3 يستخدم للعمليات الحسابية. python-owasp-zap-v2.4 0.0.22 يستخدم لتكامل OWASP ZAP. توفر هذه المكتبة واجهة برمجية للتفاعل مع ZAP API.

openai 1.3.0 يستخدم لتكامل OpenAI. توفر هذه المكتبة واجهة برمجية للتفاعل مع OpenAI API واستخدام نماذج الذكاء الاصطناعي. Werkzeug 2.3.6 يستخدم كأدوات Flask الأساسية بما في ذلك تشفير كلمات المرور.""",
        'images': ['[مكان الصورة: قائمة المكتبات - يظهر requirements.txt]']
    },
    {
        'title': 'المميزات النهائية للنظام',
        'content': """النظام النهائي يحتوي على عدة ميزات متقدمة. الميزة الأولى هي فحص أمان شامل للمواقع الإلكترونية. يقوم النظام بفحص أساسي لرؤوس HTTP واكتشاف رؤوس الأمان المهمة. يقوم أيضاً بفحص متقدم باستخدام OWASP ZAP لاكتشاف ستة عشر نوعاً من الثغرات الأمنية.

الميزة الثانية هي تحليل ذكي باستخدام OpenAI. يقوم النظام بتحليل نتائج الفحص باستخدام نماذج الذكاء الاصطناعي لتوليد تقارير احترافية مع توصيات قابلة للتطبيق. يتم تحليل جميع النتائج وتقديم تقييم شامل للمخاطر.

الميزة الثالثة هي واجهة مستخدم متقدمة. يدعم النظام اللغتين العربية والإنجليزية بشكل كامل مع دعم RTL للعربية. التصميم متجاوب ويعمل على جميع الأجهزة. الرسائل واضحة ومفيدة للمستخدمين.

الميزة الرابعة هي إدارة متكاملة. يحتوي النظام على لوحة تحكم للمستخدمين تعرض تاريخ الفحوصات. يحتوي أيضاً على لوحة تحكم للمديرين لإدارة المستخدمين والإعدادات. جميع الإعدادات قابلة للتخصيص من خلال واجهة سهلة الاستخدام.

الميزة الخامسة هي تقارير شاملة. يقوم النظام بتوليد تقارير PDF احترافية تحتوي على جميع نتائج الفحص. يتم عرض النتائج بشكل تفاعلي في صفحة النتائج. يتم تحليل جميع الثغرات بشكل مفصل مع توصيات لإصلاحها.""",
        'images': [
            '[مكان الصورة: لقطة شاشة للميزات الرئيسية - يظهر جميع القدرات]',
            '[مكان الصورة: لقطة شاشة للواجهة - يظهر التصميم الحديث]'
        ]
    },
    {
        'title': 'الخطوات المتبعة لتشغيل النظام',
        'content': """لتشغيل النظام، يجب اتباع عدة خطوات. الخطوة الأولى هي تثبيت المتطلبات. يجب فتح Terminal في مجلد المشروع وتنفيذ الأمر pip install -r requirements.txt. سيتم تثبيت جميع المكتبات المطلوبة تلقائياً.

الخطوة الثانية هي تهيئة قاعدة البيانات. قاعدة البيانات يتم إنشاؤها تلقائياً عند أول تشغيل للنظام. يتم إنشاء جميع الجداول المطلوبة تلقائياً. يتم إنشاء مستخدم admin افتراضي مع اسم المستخدم admin وكلمة المرور admin123.

الخطوة الثالثة هي تشغيل النظام. يجب تنفيذ الأمر python app.py في Terminal. سيتم تشغيل الخادم المحلي على العنوان http://localhost:5000. يجب فتح المتصفح والوصول إلى هذا العنوان.

الخطوة الرابعة هي إعداد ZAP اختياري. يجب تسجيل الدخول كمدير باستخدام بيانات admin. يجب الذهاب إلى لوحة الإدارة وتكوين إعدادات ZAP. يجب تحديد رابط ZAP Proxy وتفعيل Auto-start ZAP إذا كان ZAP مثبتاً على النظام.

الخطوة الخامسة هي إعداد OpenAI اختياري. يجب الذهاب إلى لوحة الإدارة وتكوين إعدادات OpenAI. يجب إدخال مفتاح API الخاص بـ OpenAI واختيار النموذج المطلوب. يجب تفعيل OpenAI Analysis لاستخدام التحليل الذكي.

الخطوة السادسة هي استخدام النظام. يمكن تسجيل حساب جديد أو تسجيل الدخول بحساب موجود. يجب الذهاب إلى صفحة الفحص وإدخال رابط الموقع المراد فحصه. يجب اختيار نوع الفحص سواء كان أساسياً أو متقدماً. يجب انتظار اكتمال الفحص وعرض النتائج. يمكن تحميل التقرير PDF من صفحة النتائج.""",
        'images': [
            '[مكان الصورة: لقطة شاشة لتشغيل النظام - يظهر Terminal والخادم]',
            '[مكان الصورة: لقطة شاشة لصفحة الفحص - يظهر النموذج]'
        ]
    },
    {
        'title': 'الخلاصة',
        'content': """تم تطوير نظام CyberShield AI بشكل متكامل وشامل خلال أربعة عشر أسبوعاً من العمل الدؤوب. بدأ المشروع من فكرة بسيطة لفحص أمان المواقع وصولاً إلى نظام متقدم يدعم الفحص المتقدم باستخدام OWASP ZAP والتحليل الذكي باستخدام OpenAI.

تم تنفيذ جميع المراحل بدقة مع معالجة شاملة للأخطاء وتحسينات مستمرة على الواجهات والأداء. النظام يدعم اللغتين العربية والإنجليزية بشكل كامل ويوفر واجهة مستخدم احترافية وتقارير شاملة.

النظام النهائي جاهز للاستخدام ويمكن تثبيته وتشغيله بسهولة. جميع الميزات المخطط لها تم تنفيذها بنجاح. النظام يوفر حلاً شاملاً لفحص أمان المواقع الإلكترونية مع تحليل ذكي وتقارير احترافية.

تم توثيق جميع مراحل التطوير بشكل مفصل في هذا التقرير. تم توضيح جميع المهام والخطوات التي تم تنفيذها في كل أسبوع. تم شرح جميع المكونات والتقنيات المستخدمة بشكل شامل.

المشروع يمثل إنجازاً تقنياً مهماً في مجال الأمن السيبراني. النظام يمكن أن يكون مفيداً للشركات والمطورين ومهنيي الأمن السيبراني. يمكن تطوير النظام أكثر في المستقبل بإضافة ميزات جديدة وتحسينات إضافية.""",
        'images': [
            '[مكان الصورة: لقطة شاشة نهائية للنظام - يظهر النظام الكامل]',
            '[مكان الصورة: مثال على تقرير نهائي - يظهر التقرير الكامل]'
        ]
    }
]

# Add final sections
for section in final_sections:
    doc.add_heading(section['title'], 1)
    paragraphs = section['content'].split('\n\n')
    for para in paragraphs:
        if para.strip():
            p = doc.add_paragraph(para.strip())
            p.paragraph_format.space_after = Pt(6)
    
    # Add image placeholders
    for img in section['images']:
        img_para = doc.add_paragraph(img)
        img_para.paragraph_format.left_indent = Inches(0.5)
        img_para.runs[0].font.italic = True
        img_para.runs[0].font.color.rgb = RGBColor(128, 128, 128)
        img_para.paragraph_format.space_after = Pt(12)
    
    doc.add_paragraph()

# Save the document
output_path = os.path.join(os.path.dirname(__file__), 'CyberShield_AI_Project_Report_Arabic.docx')
doc.save(output_path)
print(f"تم إنشاء ملف Word العربي بنجاح: {output_path}")


